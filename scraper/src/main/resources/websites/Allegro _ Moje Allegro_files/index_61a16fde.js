!function(e,t){for(var n in t)e[n]=t[n]}(window,function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.allegrostatic.com/opbox-user-inbox/",n(n.s=0)}({0:function(e,t,n){e.exports=n("O14P")},GI1G:function(e){e.exports=JSON.parse('{"a":"https://assets.allegrostatic.com/metrum/icon/arrowhead-9148b8f39c.svg","b":"https://assets.allegrostatic.com/metrum/icon/three-dots-cc8d7d016a.svg"}')},O14P:function(e,t,n){"use strict";n.r(t);var r={};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(r),n.d(r,"inbox",(function(){return u})),n.d(r,"inboxLoginButton",(function(){return c})),n.d(r,"messages",(function(){return l})),n.d(r,"message",(function(){return m})),n.d(r,"messageLink",(function(){return f})),n.d(r,"text",(function(){return _})),n.d(r,"messageText",(function(){return d})),n.d(r,"emptyText",(function(){return g})),n.d(r,"guestText",(function(){return p})),n.d(r,"errorText",(function(){return v})),n.d(r,"guestContentWrapper",(function(){return h})),n.d(r,"registerButton",(function(){return y})),n.d(r,"spinner",(function(){return b})),n.d(r,"messageDisplayed",(function(){return w})),n.d(r,"messageNew",(function(){return j})),n.d(r,"messageClicked",(function(){return x})),n.d(r,"messageIcon",(function(){return k})),n.d(r,"messageTime",(function(){return z})),n.d(r,"right9px",(function(){return q})),n.d(r,"messageMenuDropdown",(function(){return M})),n.d(r,"messageMenuDropdownToggle",(function(){return S})),n.d(r,"messageMenuDropdownToggleActive",(function(){return E})),n.d(r,"messageMenuDropdownContentContainer",(function(){return L})),n.d(r,"messageMenuDropdownContent",(function(){return D})),n.d(r,"messageMenuDropdownOpen",(function(){return A})),n.d(r,"messageMenuActions",(function(){return C})),n.d(r,"messageMenuAction",(function(){return O})),n.d(r,"messageMenuActionLink",(function(){return T})),n.d(r,"messageGroup",(function(){return I})),n.d(r,"messageGroupHeader",(function(){return N})),n.d(r,"messageGroupToggle",(function(){return G})),n.d(r,"arrowIcon",(function(){return P})),n.d(r,"messageGroupToggleOpen",(function(){return R})),n.d(r,"messageGroupContentInvisible",(function(){return U})),n.d(r,"messageGroupContent",(function(){return Z})),n.d(r,"messageGroupContentVisible",(function(){return K}));var u="mpof_ki myre_zn mr3m_1 m389_6m m7f5_6m _0f0f1_3ysel",c="mgn2_14 mp0t_0a m9qz_yo mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 m3h2_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r mh36_16 mvrt_16 mg9e_0 mj7a_0 m9tr_pf m2ha_2 m8qd_qh mjt1_n2 bqyr8 mgmw_9u msts_enp mrmn_qo mrhf_u8 m31c_kb m0ux_fp b1bc7 mp4t_16 mryx_32 mpof_vs mupj_5k _0f0f1_ERK1D",l="mx4z_5x mr3m_1 m7er_k4 mp4t_0 m3h2_0 mryx_0 munh_0 mg9e_0 mvrt_0 mj7a_0 mh36_0 _0f0f1_3KcyV",m="mp7g_oh mpof_z0 mp4t_0 m3h2_0 mryx_0 munh_0 mg9e_0 mvrt_0 mj7a_0 mh36_0 msts_9u _0f0f1_27WWV",f="mpof_ki mli2_1 mj9z_5r m7f5_5x m389_5x _0f0f1_3NjUU",_="_1h7wt _9hx3e",d="_1h7wt _9hx3e _0f0f1_yC03d",g="mzmg_6m mgmw_ag mg9e_24 mj7a_24",p="mgmw_ag",v="m7er_56 msts_szl mx4z_5x mg9e_16 mvrt_16 mj7a_16 mh36_16 mp4t_16",h="mzmg_6m mg9e_24 mj7a_24",y="mgn2_14 mp0t_0a m9qz_yo mp7g_oh mse2_40 mqu1_40 mtsp_ib mli8_k4 mp4t_0 m3h2_0 mryx_0 munh_0 m911_5r mefy_5r mnyp_5r mdwl_5r msbw_2 mldj_2 mtag_2 mm2b_2 mqvr_2 msa3_z4 mqen_m6 meqh_en m0qj_5r msts_n7 mh36_16 mvrt_16 mg9e_0 mj7a_0 m9tr_pf m2ha_2 m8qd_qh mjt1_n2 bqyr8 mgmw_vz mrmn_qo mrhf_u8 m31c_kb m0ux_fp boww4 mpof_vs",b="_6gjm5 mp4t_24 m3h2_24 mryx_24 munh_24",w="_0f0f1_2yU-d",j="_0f0f1_3BP2u",x="_0f0f1_1a6Wt",k="mjyo_6x mse2_40 meqh_en msa3_z4 m0s5_e6 isflp mg9e_0 mvrt_0 mj7a_0 mh36_0 mli2_0 _0f0f1_20QA1",z="_6x7yn mpof_ki m389_6m _0f0f1_ETIEc",q="_0f0f1_E6ipK",M="mp7g_f6 mqen_m6 m9tr_5r _0f0f1_E6ipK _0f0f1_248ly",S="_w7z6o _ypulx m9vn_d2 m9vn_gl_m _0f0f1_2e_I7",E="m9vn_d2",L="mp7g_oh",D="mp7g_f6 mpof_5r mjyo_6x mjb5_w6 mg9e_0 mvrt_0 mj7a_0 mh36_0 msts_9u mx7m_1 m911_co mefy_co mnyp_co mdwl_co mlkp_ag mnjl_0 _0f0f1_wYIFj",A="_0f0f1_3JGSa",C="_3a4zn _12vfa m7er_k4 mzmg_6m mh36_16 mvrt_16 _0f0f1_2_Zk-",O="_1bmp9 mryx_0",T="_w7z6o _ypulx mtsp_ib",I="_0f0f1_3CcuH",N="mp7g_oh _0f0f1_2SLxp",G="mp7g_f6 mqen_m6 _0f0f1_E6ipK _0f0f1_2xCmc",P="mjyo_6x mse2_40 meqh_en msa3_z4 m0s5_e6 isflp mg9e_0 mvrt_0 mj7a_0 mh36_0 _0f0f1_3d2yY",R="_0f0f1_337Tu",U="mpof_5r",Z="mpof_5r _0f0f1_1qkU4 _0f0f1_2csNU",K="mpof_z0";function V(e){if(Array.isArray(e))return e}function H(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t){if(e){if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}function F(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(e,t){return V(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}}(e,t)||B(e,t)||F()}function Y(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},$=RegExp(Object.keys(Q).join("|"),"g");function X(e){return new ee([e+""],[])}var ee=function(){function e(t,n){o(this,e),this._parts=t,this._subs=n}return i(e,[{key:"_escapeHtml",value:function(t){return t instanceof e?t:Array.isArray(t)?(null==(o="")&&(o=","),(r=t).length<=0?new ee([""],[]):new ee([""].concat(function(e){if(Array.isArray(e))return W(e)}(n=Array(r.length-1).fill(o))||H(n)||B(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[""]),r)):(t+"").replace($,(function(e){return Q[e]}));var n,r,o}},{key:"toString",value:function(){var e=this;return this._parts.reduce((function(t,n,r){var o=e._subs[r-1];return t+e._escapeHtml(o)+n}))}},{key:"inspect",value:function(){return"".concat(this.constructor.name," '").concat(this.toString(),"'")}}]),e}();function te(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new ee(e,n)}var ne,re=n("GI1G"),oe=(ne=r,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return ne[e]||e})).join(" ")});function ae(){var e=Y(['<div class="','">','<a href="','" class="','" rel="nofollow" data-role="login-button">Zaloguj się</a>','<a href="','" class="','" rel="nofollow" data-analytics-clickable data-role="register-button">Zarejestruj się</a></div>']);return ae=function(){return e},e}function ie(){var e=Y(['<p class="'," ",'">',"</p>"]);return ie=function(){return e},e}function se(){var e=Y(['<ul class="','" data-role="message-list">',"</ul>"]);return se=function(){return e},e}function ue(){var e=Y(['<li class="','"><ol class="','">'," ",'</ol><ol data-role="message-group-content" class="','">',"</ol></li>"]);return ue=function(){return e},e}function ce(){var e=Y(['<div class="','" data-role="message-group-toggle">',"</div>"]);return ce=function(){return e},e}function le(){var e=Y(['<li class="','" data-role="message">'," ","</li>"]);return le=function(){return e},e}function me(){var e=Y(['<a data-role="message-link" href="','" class="','" data-analytics-clickable data-analytics-click-value="','">','<span><span class="','">',"</span>","</span></a>"]);return me=function(){return e},e}function fe(){var e=Y(['<div class="','" data-role="message-actions-dropdown"><button type="button" aria-label="Zarządzaj tą wiadomością" class="','">','</button><div class="','"><div class="','">',"</div></div></div>"]);return fe=function(){return e},e}function _e(){var e=Y(['<ul class="','"><li class="','"><button type="button" class="','" data-role="','" data-id-to-delete="','">',"</button></li></ul>"]);return _e=function(){return e},e}function de(){var e=Y(['<img class="','" src="','" alt="Kategoria" width="100%" height="100%" />']);return de=function(){return e},e}function ge(){var e=Y(['<time class="','" datetime="','" aria-label="Wysłane ','">',"</time>"]);return ge=function(){return e},e}function pe(){var e=Y(['<img class="','" src="','" alt="Rozwiń menu" width="100%" height="100%" />']);return pe=function(){return e},e}function ve(){var e=Y(['<img class="','" src="','" alt="Rozwiń grupę" width="100%" height="100%" />']);return ve=function(){return e},e}var he,ye=(he=new Date,function(e){var t=function(e){if(e>=2592e3)return"ponad miesiąc";if(e>=86400){var t=Math.floor(e/86400),n=1===t?"dzień":"dni";return"".concat(t," ").concat(n)}return e>=3600?"".concat(Math.floor(e/3600)," godz."):"".concat(Math.max(1,Math.floor(e/60))," min.")}(Math.floor((he-e)/1e3));return"".concat(t," temu")}),be=te(ve(),P,re.a),we=te(pe(),P,re.b);function je(e,t,n){var r=J(e?["action-delete-group","usuń cały wątek",t]:["action-delete","usuń wiadomość",n],3),o=r[0],a=r[1],i=r[2];return te(_e(),C,O,T,o,i,a)}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return te(fe(),M,S,we,L,D,je(t,n,e))}function ke(e,t,n,r){var o="".concat("/inbox/redirect/id/").concat(t);return te(me(),o,f,n,function(e){return te(de(),k,e)}(r),d,n,X(function(e){var t=new Date(e),n=t.toLocaleDateString(),r=ye(t);return te(ge(),z,n,r,r)}(e)))}function ze(e){var t=e.text,n=e.image.svg,r=e.status,o=e.createdAt,a=e.tinkerbellId,i=e.groupId,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],u=oe("message","message".concat(r.charAt(0)+r.slice(1).toLowerCase()));return te(le(),u,xe(a,s,i),ke(o,a,t,n))}var qe=function(e){return ze(e,!1)};function Me(e){if(1===e.length)return qe(e[0]);var t,n=V(t=e)||H(t)||B(t)||F(),r=n[0],o=n.slice(1),a=ze(r,!0),i=o.map(qe).join(""),s=te(ce(),G,be);return te(ue(),I,N,X(a),X(s),Z,X(i))}function Se(e){return"".concat("group_").concat(e)}function Ee(e){var t=e.className,n=e.content;return te(ie(),t,_,X(n))}function Le(){return Ee({className:g,content:"Nie masz żadnych <br>nowych powiadomień."})}function De(e){var t=Ee({className:p,content:"Zaloguj się, aby zobaczyć <br>swoje powiadomienia."}),n=Ee({className:p,content:"Nie masz jeszcze konta?"}),r="/login/auth?origin_url=".concat(encodeURIComponent(e.location));return te(ae(),h,X(t),r,c,X(n),"/rejestracja",y)}var Ae=".".concat(I),Ce=function(){function e(t,n,r,a){var i=this;o(this,e),s(this,"onOpen",(function(){i.root.removeEventListener("inViewport",i.onOpen,!1),i.api.getMessages().then(i.onResponse).catch(i.onError)})),s(this,"onResponse",(function(e){var t,n=e.data,r=(t=n.messages).length>0?function(e){var t=function(e){var t=e.reduce((function(e,t){var n=e,r=t.groupId||t.tinkerbellId;return(n[Se(r)]||(n[Se(r)]=[])).push(t),n}),{});return Object.values(t)}(e).map(Me).join("");return te(se(),l,X(t))}(t):Le();i.setContent(r),i.setupListeners(),i.handleDisplayed(n)})),s(this,"onError",(function(e){var t=401===e.status?De(i.window):Ee({className:v,content:"Nie mogliśmy wyświetlić Twoich powiadomień."});i.setContent(t)})),s(this,"setContent",(function(e){i.content.innerHTML=e})),s(this,"handleDisplayed",(function(e){var t=e.messages;i.services&&i.services.get("opbox-notification-service").then((function(e){e.reset("inboxes")}));var n=t.filter((function(e){return"CLICKED"!==e.status}));n.length>0&&i.api.updateStatusToDisplayed(n.map((function(e){return e.tinkerbellId})))})),s(this,"setupListeners",(function(){i.root.querySelectorAll('[data-role="message-group-toggle"]').forEach((function(e){return e.addEventListener("click",i.toggleGroupVisibility)})),i.root.querySelectorAll('button[aria-label="Zarządzaj tą wiadomością"]').forEach((function(e){return e.addEventListener("click",i.toggleDeleteMessageDropdown)})),i.root.querySelectorAll('[data-role="action-delete"]').forEach((function(e){return e.addEventListener("click",i.singleMessageDeleteListener(e.dataset.idToDelete))})),i.root.querySelectorAll('[data-role="action-delete-group"]').forEach((function(e){return e.addEventListener("click",i.groupMessageDeleteListener(e.dataset.idToDelete))}))})),s(this,"toggleDeleteMessageDropdown",(function(e){e.preventDefault();var t=e.currentTarget.parentElement.parentElement.querySelector('[data-role="message-actions-dropdown"]'),n=t.classList.contains(A);i.root.querySelectorAll('[data-role="message-actions-dropdown"]').forEach(i.hideActionsDropdown),n||(t.classList.add(A),t.querySelector('button[aria-label="Zarządzaj tą wiadomością"]').classList.add(E))})),s(this,"toggleGroupVisibility",(function(e){e.preventDefault();var t=e.currentTarget,n=t.parentElement;if(n){t.classList.toggle(R);var r=n.parentElement.querySelector('[data-role="message-group-content"]');r.classList.toggle(K),r.classList.toggle(U)}})),this.window=t,this.api=n,this.root=r,this.content=r.querySelector('[data-role="inbox"]'),this.services=a}return i(e,[{key:"initialize",value:function(){null!==function(e){for(var t=document.cookie.split(/;\s*/),n=t.length-1;n>=0;n-=1){var r=J(t[n].split("=").map((function(e){return decodeURIComponent(e)})),2),o=r[0],a=r[1];if("qeppo_login2"===o)return a}return null}()?this.root.addEventListener("inViewport",this.onOpen,!1):this.setContent(De(this.window))}},{key:"groupMessageDeleteListener",value:function(e){var t=this;return function(n){n.stopPropagation(),t.api.deleteGroup(e),t.deleteMessageListItem(n.target.closest(Ae)),t.window.opbox.analytics.sendClickEvent({contextNode:t.root,label:"deleteMessageGroup",value:e})}}},{key:"deleteMessageListItem",value:function(e){e.remove(),this.root.querySelectorAll('[data-role="message"]').length||(this.content.innerHTML=Le())}},{key:"singleMessageDeleteListener",value:function(e){var t=this;return function(n){n.stopPropagation(),t.api.delete(e),t.deleteSingleMessage(n.target.closest('[data-role="message"]')),t.window.opbox.analytics.sendClickEvent({contextNode:t.root,label:"deleteSingleMessage",value:e})}}},{key:"deleteSingleMessage",value:function(e){var t=e.parentNode,n=t.matches('[data-role="message-group-content"]'),r=1===t.childElementCount;n&&r&&this.removeGroupToggleControls(t),this.deleteMessageListItem(e)}},{key:"removeGroupToggleControls",value:function(e){var t=e.parentNode.querySelector('[data-role="message-group-toggle"]');e.remove(),t.remove()}},{key:"hideActionsDropdown",value:function(e){e.classList.remove(A),e.querySelector('button[aria-label="Zarządzaj tą wiadomością"]').classList.remove(E)}}]),e}(),Oe={withCredentials:!0,headers:{Accept:"application/json","Content-type":"application/json"}},Te=Object.assign({},Oe,{headers:Object.assign({},Oe.headers,{"Content-type":"application/vnd.allegro.public.v2+json"})}),Ie=function(){function e(t){o(this,e);var n=t.opbox.edge;this.edge=n}return i(e,[{key:"getMessages",value:function(){return this.edge.get("/inbox/messages",Oe)}},{key:"updateStatusToDisplayed",value:function(e){var t={tinkerbellIdEvents:e.map((function(e){return{tinkerbellId:e}}))};this.edge.post("/inbox/events/displayed",t,Te)}},{key:"delete",value:function(e){this.edge.delete("".concat("/inbox/messages","/").concat(e),Oe)}},{key:"deleteGroup",value:function(e){this.edge.delete("".concat("/inbox/messages/group","/").concat(e),Oe)}}]),e}(),Ne=function(){function e(t){var n=t.baseNode,r=t.services;o(this,e),this.baseNode=n,this.services=r}return i(e,[{key:"onMount",value:function(){var e=new Ie(window);new Ce(window,e,this.baseNode,this.services).initialize()}}]),e}();window.opbox.component.register({prototypeName:"allegro.user.inbox"},Ne)}}));
//# sourceMappingURL=index_61a16fde.js.map