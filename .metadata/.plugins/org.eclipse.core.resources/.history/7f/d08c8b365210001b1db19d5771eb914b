package scrapers;

import java.util.List;

import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlElement;
import com.gargoylesoftware.htmlunit.html.HtmlForm;
import com.gargoylesoftware.htmlunit.html.HtmlInput;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class NetflixScraper {

	
public static void main(String[] args) {
	
	WebClient client = new WebClient();
	client.getOptions().setCssEnabled(true);
	client.getOptions().setJavaScriptEnabled(true);
	try {
	
		HtmlPage page = (HtmlPage) client.getPage("https://www.netflix.com/pl/login");
		HtmlForm form = page.getFormByName("login-form");
		form.getInputByName("username").setValueAttribute("hube0x@gmail.com"); 
		form.getInputByName("password").setValueAttribute("Liwiaihubertnetflix2543");
		
		page = form.getInputByValue("Log On").click(); // works fine
		
		System.out.println(page.asText()); 	
		
		
		String searchUrl = "https://www.netflix.com/YourAccount";
		HtmlPage page2 = client.getPage(searchUrl);
		  
		List<HtmlElement> items = (List<HtmlElement>) page2.getByXPath("//li[@class='single-profile']") ;
		if(items.isEmpty()){
		  System.out.println("No items found !");
		}else{
		for(HtmlElement item : items){
		
		  HtmlAnchor itemAnchor = ((HtmlAnchor) item.getFirstByXPath(".//a/span[@data-uia='action-viewing-activity']")) ;
		
		  String itemUrl =  itemAnchor.getHrefAttribute();
		
		  
		  System.out.println(itemUrl);
		  }
		}
	  
	}catch(Exception e){
	  e.printStackTrace();
	}
	
	
	
}
}
