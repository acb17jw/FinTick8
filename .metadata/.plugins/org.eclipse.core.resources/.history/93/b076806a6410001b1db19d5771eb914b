package scrapers;

import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlButton;
import com.gargoylesoftware.htmlunit.html.HtmlElement;
import com.gargoylesoftware.htmlunit.html.HtmlForm;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class AllegroSmartScraper {

	public static void main(String[] args) {
		
		WebClient client = new WebClient();
		client.getOptions().setCssEnabled(false);
		client.getOptions().setJavaScriptEnabled(false);
		try {
		
			HtmlPage page = (HtmlPage) client.getPage("https://www.allegro.pl/login/auth?origin_url=%2F");
			System.out.println(page.asText()); 
			HtmlForm form = page.getFormByValue("loginForm");
			form.getInputByName("username").setValueAttribute("hb12@o2.pl"); 
			form.getInputByName("password").setValueAttribute("Jinrty12");
			
			System.out.println("pass: "+ form.getInputByName("password").asText());
			HtmlButton submitButton = form.getFirstByXPath("//button[@id'login-button']");
			page = submitButton.click();
			System.out.println(page.asText()); 	
			
		
			HtmlPage page2 = client.getPage("https://allegro.pl/moje-allegro/zakupy/kupione");
			  
			
			HtmlElement lastBoughtItem = (HtmlElement) page2.getFirstByXPath("//div[@class='w1eai al110x xz3ls m1o1o']");
			
			System.out.println("Last bought: " + lastBoughtItem.asText());
			
		}catch(Exception e){
		  e.printStackTrace();
		}
		
		
		
	}
	
}
